2025-11-19 01:48:39,625 - INFO - Loaded 29768 samples, embedding dim: 1024
2025-11-19 01:48:39,627 - INFO - Label distribution: Counter({'angry': 5084, 'disgust': 5084, 'fear': 5084, 'happy': 5084, 'sad': 5084, 'neutral': 4348})
2025-11-19 01:48:39,630 - INFO - Starting 5-fold cross-validation
2025-11-19 01:48:39,637 - INFO - 
--- Fold 1/5 ---
2025-11-19 01:48:39,938 - INFO - Class weights: {np.int64(0): np.float64(0.9759036144578314), np.int64(1): np.float64(0.9759036144578314), np.int64(2): np.float64(0.9759036144578314), np.int64(3): np.float64(0.9759036144578314), np.int64(4): np.float64(1.1408450704225352), np.int64(5): np.float64(0.9759036144578314)}
2025-11-19 01:48:39,938 - INFO - Training MLP on cpu
2025-11-19 01:49:21,464 - INFO - Epoch 10/100 - Loss: 0.8042, Val Acc: 0.7083, Val F1: 0.7069
2025-11-19 01:49:52,359 - INFO - Epoch 20/100 - Loss: 0.6448, Val Acc: 0.7361, Val F1: 0.7358
2025-11-19 01:50:20,872 - INFO - Epoch 30/100 - Loss: 0.5277, Val Acc: 0.7679, Val F1: 0.7683
2025-11-19 01:50:49,010 - INFO - Epoch 40/100 - Loss: 0.4551, Val Acc: 0.7613, Val F1: 0.7616
2025-11-19 01:51:17,571 - INFO - Epoch 50/100 - Loss: 0.4016, Val Acc: 0.7768, Val F1: 0.7769
2025-11-19 01:51:45,977 - INFO - Epoch 60/100 - Loss: 0.3699, Val Acc: 0.7773, Val F1: 0.7786
2025-11-19 01:52:14,495 - INFO - Epoch 70/100 - Loss: 0.3261, Val Acc: 0.7849, Val F1: 0.7844
2025-11-19 01:52:43,143 - INFO - Epoch 80/100 - Loss: 0.3085, Val Acc: 0.7830, Val F1: 0.7824
2025-11-19 01:53:11,749 - INFO - Epoch 90/100 - Loss: 0.2830, Val Acc: 0.7872, Val F1: 0.7875
2025-11-19 01:53:40,405 - INFO - Epoch 100/100 - Loss: 0.2599, Val Acc: 0.7902, Val F1: 0.7906
2025-11-19 01:53:40,459 - INFO - Fold 1 - Acc: 0.7902, F1(weighted): 0.7906, F1(macro): 0.7913
2025-11-19 01:53:40,459 - INFO - 
--- Fold 2/5 ---
2025-11-19 01:53:40,761 - INFO - Class weights: {np.int64(0): np.float64(0.9759036144578314), np.int64(1): np.float64(0.9759036144578314), np.int64(2): np.float64(0.9759036144578314), np.int64(3): np.float64(0.9756637168141593), np.int64(4): np.float64(1.1411730879815987), np.int64(5): np.float64(0.9759036144578314)}
2025-11-19 01:53:40,761 - INFO - Training MLP on cpu
2025-11-19 01:54:09,117 - INFO - Epoch 10/100 - Loss: 0.7872, Val Acc: 0.7014, Val F1: 0.6995
2025-11-19 01:54:37,464 - INFO - Epoch 20/100 - Loss: 0.6333, Val Acc: 0.7333, Val F1: 0.7312
2025-11-19 01:55:06,035 - INFO - Epoch 30/100 - Loss: 0.5252, Val Acc: 0.7476, Val F1: 0.7477
2025-11-19 01:55:34,785 - INFO - Epoch 40/100 - Loss: 0.4514, Val Acc: 0.7665, Val F1: 0.7660
2025-11-19 01:56:03,184 - INFO - Epoch 50/100 - Loss: 0.3903, Val Acc: 0.7670, Val F1: 0.7664
2025-11-19 01:56:31,450 - INFO - Epoch 60/100 - Loss: 0.3681, Val Acc: 0.7739, Val F1: 0.7740
2025-11-19 01:56:59,689 - INFO - Epoch 70/100 - Loss: 0.3217, Val Acc: 0.7808, Val F1: 0.7805
2025-11-19 01:57:28,258 - INFO - Epoch 80/100 - Loss: 0.3055, Val Acc: 0.7843, Val F1: 0.7838
2025-11-19 01:57:56,556 - INFO - Epoch 90/100 - Loss: 0.2754, Val Acc: 0.7810, Val F1: 0.7805
2025-11-19 01:58:25,243 - INFO - Epoch 100/100 - Loss: 0.2678, Val Acc: 0.7835, Val F1: 0.7833
2025-11-19 01:58:25,296 - INFO - Fold 2 - Acc: 0.7835, F1(weighted): 0.7833, F1(macro): 0.7837
2025-11-19 01:58:25,297 - INFO - 
--- Fold 3/5 ---
2025-11-19 01:58:25,530 - INFO - Class weights: {np.int64(0): np.float64(0.9759036144578314), np.int64(1): np.float64(0.9759036144578314), np.int64(2): np.float64(0.9756637168141593), np.int64(3): np.float64(0.9759036144578314), np.int64(4): np.float64(1.1411730879815987), np.int64(5): np.float64(0.9759036144578314)}
2025-11-19 01:58:25,530 - INFO - Training MLP on cpu
2025-11-19 01:58:54,477 - INFO - Epoch 10/100 - Loss: 0.7959, Val Acc: 0.7037, Val F1: 0.7028
2025-11-19 01:59:22,990 - INFO - Epoch 20/100 - Loss: 0.6365, Val Acc: 0.7318, Val F1: 0.7314
2025-11-19 01:59:51,446 - INFO - Epoch 30/100 - Loss: 0.5317, Val Acc: 0.7467, Val F1: 0.7462
2025-11-19 02:00:20,000 - INFO - Epoch 40/100 - Loss: 0.4543, Val Acc: 0.7563, Val F1: 0.7562
2025-11-19 02:00:48,240 - INFO - Epoch 50/100 - Loss: 0.4045, Val Acc: 0.7665, Val F1: 0.7657
2025-11-19 02:01:16,644 - INFO - Epoch 60/100 - Loss: 0.3706, Val Acc: 0.7753, Val F1: 0.7753
2025-11-19 02:01:44,914 - INFO - Epoch 70/100 - Loss: 0.3354, Val Acc: 0.7741, Val F1: 0.7742
2025-11-19 02:02:07,445 - INFO - Early stopping at epoch 78
2025-11-19 02:02:07,497 - INFO - Fold 3 - Acc: 0.7805, F1(weighted): 0.7801, F1(macro): 0.7808
2025-11-19 02:02:07,498 - INFO - 
--- Fold 4/5 ---
2025-11-19 02:02:07,708 - INFO - Class weights: {np.int64(0): np.float64(0.975944594705352), np.int64(1): np.float64(0.9757046869878728), np.int64(2): np.float64(0.975944594705352), np.int64(3): np.float64(0.975944594705352), np.int64(4): np.float64(1.141221008242285), np.int64(5): np.float64(0.9757046869878728)}
2025-11-19 02:02:07,708 - INFO - Training MLP on cpu
2025-11-19 02:02:35,406 - INFO - Epoch 10/100 - Loss: 0.7984, Val Acc: 0.7138, Val F1: 0.7118
2025-11-19 02:03:03,163 - INFO - Epoch 20/100 - Loss: 0.6385, Val Acc: 0.7418, Val F1: 0.7427
2025-11-19 02:03:30,851 - INFO - Epoch 30/100 - Loss: 0.5280, Val Acc: 0.7642, Val F1: 0.7628
2025-11-19 02:03:58,535 - INFO - Epoch 40/100 - Loss: 0.4531, Val Acc: 0.7715, Val F1: 0.7713
2025-11-19 02:04:26,049 - INFO - Epoch 50/100 - Loss: 0.4046, Val Acc: 0.7756, Val F1: 0.7755
2025-11-19 02:04:53,971 - INFO - Epoch 60/100 - Loss: 0.3606, Val Acc: 0.7791, Val F1: 0.7788
2025-11-19 02:05:21,891 - INFO - Epoch 70/100 - Loss: 0.3361, Val Acc: 0.7838, Val F1: 0.7828
2025-11-19 02:05:49,686 - INFO - Epoch 80/100 - Loss: 0.3044, Val Acc: 0.7905, Val F1: 0.7903
2025-11-19 02:06:17,728 - INFO - Epoch 90/100 - Loss: 0.2872, Val Acc: 0.7867, Val F1: 0.7864
2025-11-19 02:06:45,262 - INFO - Epoch 100/100 - Loss: 0.2661, Val Acc: 0.7835, Val F1: 0.7841
2025-11-19 02:06:45,314 - INFO - Fold 4 - Acc: 0.7835, F1(weighted): 0.7841, F1(macro): 0.7843
2025-11-19 02:06:45,315 - INFO - 
--- Fold 5/5 ---
2025-11-19 02:06:45,541 - INFO - Class weights: {np.int64(0): np.float64(0.9757046869878728), np.int64(1): np.float64(0.975944594705352), np.int64(2): np.float64(0.975944594705352), np.int64(3): np.float64(0.975944594705352), np.int64(4): np.float64(1.1408929769090734), np.int64(5): np.float64(0.975944594705352)}
2025-11-19 02:06:45,542 - INFO - Training MLP on cpu
2025-11-19 02:07:13,568 - INFO - Epoch 10/100 - Loss: 0.7938, Val Acc: 0.7079, Val F1: 0.7064
2025-11-19 02:07:41,523 - INFO - Epoch 20/100 - Loss: 0.6390, Val Acc: 0.7396, Val F1: 0.7388
2025-11-19 02:08:09,291 - INFO - Epoch 30/100 - Loss: 0.5377, Val Acc: 0.7591, Val F1: 0.7591
2025-11-19 02:08:37,150 - INFO - Epoch 40/100 - Loss: 0.4590, Val Acc: 0.7678, Val F1: 0.7679
2025-11-19 02:09:05,104 - INFO - Epoch 50/100 - Loss: 0.4000, Val Acc: 0.7764, Val F1: 0.7771
2025-11-19 02:09:32,989 - INFO - Epoch 60/100 - Loss: 0.3550, Val Acc: 0.7774, Val F1: 0.7781
2025-11-19 02:10:01,141 - INFO - Epoch 70/100 - Loss: 0.3328, Val Acc: 0.7865, Val F1: 0.7865
2025-11-19 02:10:29,299 - INFO - Epoch 80/100 - Loss: 0.3164, Val Acc: 0.7840, Val F1: 0.7838
2025-11-19 02:10:57,099 - INFO - Epoch 90/100 - Loss: 0.2883, Val Acc: 0.7887, Val F1: 0.7887
2025-11-19 02:11:25,019 - INFO - Epoch 100/100 - Loss: 0.2766, Val Acc: 0.7872, Val F1: 0.7859
2025-11-19 02:11:25,070 - INFO - Fold 5 - Acc: 0.7872, F1(weighted): 0.7859, F1(macro): 0.7864
2025-11-19 02:11:25,071 - INFO - 
Average Accuracy: 0.7850 Â± 0.0034
2025-11-19 02:11:25,071 - INFO - Average F1 (weighted): 0.7848 Â± 0.0035
2025-11-19 02:11:25,071 - INFO - Average F1 (macro): 0.7853 Â± 0.0035
2025-11-19 02:11:25,072 - INFO - Saved CV results to /workspaces/-SpeechEmbeddings-WavLM/models/mlp_cv_results.json
2025-11-19 02:11:25,072 - INFO - 
--- Training final model on full dataset ---
2025-11-19 02:11:25,271 - INFO - Class weights: {np.int64(0): np.float64(0.9759036144578314), np.int64(1): np.float64(0.9759036144578314), np.int64(2): np.float64(0.9759036144578314), np.int64(3): np.float64(0.9759036144578314), np.int64(4): np.float64(1.1408450704225352), np.int64(5): np.float64(0.9759036144578314)}
2025-11-19 02:11:25,272 - INFO - Training MLP on cpu
2025-11-19 02:11:52,988 - INFO - Epoch 10/100 - Loss: 0.7973, Val Acc: 0.7143, Val F1: 0.7128
2025-11-19 02:12:21,985 - INFO - Epoch 20/100 - Loss: 0.6365, Val Acc: 0.7422, Val F1: 0.7416
2025-11-19 02:12:49,963 - INFO - Epoch 30/100 - Loss: 0.5411, Val Acc: 0.7645, Val F1: 0.7654
2025-11-19 02:13:17,951 - INFO - Epoch 40/100 - Loss: 0.4611, Val Acc: 0.7689, Val F1: 0.7679
2025-11-19 02:13:45,708 - INFO - Epoch 50/100 - Loss: 0.4081, Val Acc: 0.7884, Val F1: 0.7877
2025-11-19 02:14:13,546 - INFO - Epoch 60/100 - Loss: 0.3710, Val Acc: 0.7890, Val F1: 0.7891
2025-11-19 02:14:41,296 - INFO - Epoch 70/100 - Loss: 0.3348, Val Acc: 0.7815, Val F1: 0.7812
2025-11-19 02:15:09,207 - INFO - Epoch 80/100 - Loss: 0.3133, Val Acc: 0.7827, Val F1: 0.7823
2025-11-19 02:15:36,944 - INFO - Epoch 90/100 - Loss: 0.2809, Val Acc: 0.7887, Val F1: 0.7880
2025-11-19 02:16:05,118 - INFO - Epoch 100/100 - Loss: 0.2738, Val Acc: 0.7981, Val F1: 0.7980
2025-11-19 02:16:05,271 - INFO - 
ðŸŽ¯ Final Test Accuracy: 0.7981
2025-11-19 02:16:05,271 - INFO - ðŸŽ¯ Final Test F1 (weighted): 0.7980
